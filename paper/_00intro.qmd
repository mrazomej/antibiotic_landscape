---
editor:
    render-on-save: true
bibliography: references.bib
csl: ieee.csl
---

Understanding how genotypes encode phenotypes that allow organisms to survive
and reproduce in different environments is one of the central challenges for
modern evolutionary biology [@Lassig2017; @manrubia2021]. Although the field has
seen a surge in predictive modeling being deployed in real-world applications
ranging from viral dynamics [@uksza2014] to cancer immunotherapy [@luksza2017],
it is still unclear to what extent evolutionary trajectories under different
environmental pressures can be predicted. Two main challenges make this question
difficult to answer. First, the vast number of genetic changes available to a
population makes it impossible to exhaustively sample and measure the phenotypic
consequences of each mutation [@louis2016]. Second, for most but a few simple
model systems, it is unknown what the phenotypic changes driving adaptation are
[@shoval2012].

Nevertheless, advances in modern high-throughput technologies have made it
possible to measure the fitness of multiple genotypes, opening up the
possibility of extracting valuable information about the
genotype-phenotype-fitness map from these datasets [@kinsler2020; @maeda2020;
@iwasawa2022; @ascensao2023]. Moreover, an extensive body of empirical studies
and theoretical work has suggested that the dynamics of adaptation are highly
constrained, making them potentially predictable [@weinreich2006; @wagner2008;
@louis2016; @furusawa2018]. 

Inspired by this body of work and the impressive results that the deep-learning
revolution has achieved in the life sciences [@martin2024], we set out to
develop a data-driven framework to uncover the underlying structure of the
phenotype-fitness map from high-throughput fitness data. We consider three main
ingredients for a computational method to tackle this challenge:

1.  The method should be able to take advantage of the data-rich landscape of
modern biology, where high-throughput fitness measurements are becoming
increasingly common [@kinsler2020; @maeda2020; @iwasawa2022; @ascensao2023].

2. It should be able to uncover the potentially hidden simplicity in the
structure of the high-dimensional datasets generated by these experiments by
projecting them into a lower-dimensional space in a principled way visualizable
by humans.

3. The generated low-dimensional map should be accompanied by the corresponding
geometric information on how the high-dimensional space is folded into the map,
making the distances on the map meaningful in the high-dimensional space.

Here, we propose the use of a geometry-informed variational autoencoder---a
neural network architecture that embeds high-dimensional data into a
low-dimensional space while simultaneously learning the geometric
transformations that map the learned low-dimensional space back into the
high-dimensional space via a metric tensor [@chadebec2020]. To validate the
applicability of this method to high-dimensional fitness data, we develop a
simple model of adaptive dynamics that captures the main qualitative features of
the data generated by high-throughput fitness assays. In this model, multiple
lineages perform a biased random walk on a low-dimensional phenotypic space
towards regions of higher fitness, defined by the environment-specific
topography of the fitness landscape. Changing the environment, therefore,
amounts to changing the landscape topography while keeping the phenotypic
coordinates of the lineages constant. We show that the geometry-informed
variational autoencoder (hereafter *RHVAE* for Riemannian Hamiltonian
Variational Autoencoder [@chadebec2020]) is able to learn a low-dimensional
embedding that retains information about the relative positions of the simulated
lineages in the original phenotypic space. 

We then apply this method to a dataset of high-throughput fitness measurements
of *E. coli* under different antibiotic pressures [@iwasawa2022]. Using
$IC_{50}$ values across eight antibiotics for lineages evolved under
tetracycline, kanamycin, and norfloxacin, we demonstrate that the RHVAE learns a
low-dimensional embedding that effectively separates different evolutionary
trajectories. Our analysis reveals that a two-dimensional RHVAE achieves
reconstruction accuracy comparable to a five-dimensional PCA model, while
providing superior predictive power for out-of-sample antibiotic responses.
Through cross-validation, we show that our non-linear latent space coordinates
more accurately predict resistance profiles than any number of linear
components. Taken together, our results suggest that high-dimensional fitness
data, such as the one studied here in *E. coli*, can reveal hidden simplicity in
evolutionary dynamics when analyzed with the right computational framework,
offering new insights into the constraints and predictability of antibiotic
resistance evolution.