---
editor:
    render-on-save: true
bibliography: references.bib
csl: ieee.csl
---

## Non-Linear Latent Space Coordinates are more Predictive of Out of Sample Data

In our simulations, we designed abstract phenotypic coordinates that determined
fitness across environments. Applying our proposed method demonstrated that the
nonlinear latent space can recover the relative positions in this abstract
phenotypic space using fitness data only. While these latent coordinates don't
necessarily represent interpretable biological traits, they effectively capture
the underlying structure of the space that determines the genotype fitness in
different environments. This success in recovering structural relationships from
simulated data encouraged us to test whether the equivalent latent coordinates
recovered from experimental data can be used to make more accurate predictions
of out-of-sample data.

To test this hypothesis, we adapted the cross-validation approach developed by
@kinsler2020. Their original method assesses how linear components predict
out-of-sample data by dividing the data matrix into quadrants based on genotypes
and antibiotics. We modified this approach for our nonlinear models as shown in
@fig-07(A). First, we train our models (VAE and RHVAE) on fitness profiles from
all but one antibiotic to generate latent space coordinates. Then, we freeze
these coordinates and train only the decoder part to predict responses to the
missing antibiotic. This approach allows us to directly compare how well
different dimensionality reduction methods capture information needed for
prediction. In essence, we use seven antibiotics to place each genotype in
latent space, then test how accurately these coordinates predict resistance to
the eighth antibiotic. We direct interested readers to the Supplementary
Material for a detailed description of the of both approaches.

@fig-07(B) compares the predictive power of the three models across different
numbers of linear latent space dimensions in terms of reconstruction error. For
each panel, the accuracy of the predicted $IC_{50}$ value on the missing
antibiotic over the validation set is plotted as a function of the number of
linear dimensions used in the SVD bi-cross validation approach. The horizontal
dashed lines represent the accuracy of the predicted $IC_{50}$ value for the
2D-VAE (dark blue) and 2D-RHVAE (dark red) models. For all antibiotics, the 2D
nonlinear latent space coordinates are more predictive of the missing
antibiotic $IC_{50}$ values than any number of possible linear dimensions. This
result is consistent with the hypothesis that the nonlinear latent space
coordinates capture more information about the phenotypic state of the system
under study, allowing for more accurate predictions of out-of-sample data.
Furthermore, increasing the dimensionality of the nonlinear latent space from
two to three dimensions only marginally improves the predictive power of the
model, suggesting that the 2D nonlinear latent space captures most of the
information about the phenotypic state of the system (see Supplementary Material
for a detailed discussion).

![**Nonlinear latent space models demonstrate superior predictive power for
out-of-sample antibiotic data**. (A) Schematic representation of the
cross-validation approach used to test predictive power: training a full model
on all but one antibiotic to generate latent space coordinates (left), then
freezing the encoder parameters and training a decoder-only model on the missing
antibiotic data (right). (B) Comparison of predictive accuracy across models,
showing reconstruction error for the missing antibiotic as a function of linear
dimensions used in SVD bi-cross validation. Horizontal dashed lines represent
the accuracy of 2D-VAE (dark blue) and 2D-RHVAE (dark red) models. For all
antibiotics, the 2D nonlinear latent space coordinates provide more accurate
predictions than any number of linear dimensions, demonstrating that nonlinear
latent space representations capture more meaningful biological information
about the underlying phenotypic state.](./fig/main/fig07_v01_compiled){#fig-07}